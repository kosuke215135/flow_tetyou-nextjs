# 目的

現在のプロンプトは、ユーザーが答えにくい質問を生成してしまい、なぜなぜ分析による具体的なアクションプランへの誘導が弱い状態です。両キャラクター（ドゥイットくん・リスナーさん）とも「なぜなぜで掘り下げて具体的なアクションを導き出す」という共通目的を明確にし、ユーザーが答えやすく、アクション志向の質問を生成できるようにプロンプトを改善します。

# ゴール

- 両キャラクターの共通目的を明確化：「なぜなぜ分析で具体的なアクションプランを導き出す」
- ユーザーが答えやすい質問を生成する（抽象的・哲学的な質問を避ける）
- 段階的に掘り下げて、最終的に明日から実行できる具体的なアクションへ導く
- キャラクター性は維持しつつ、実用性を重視

## 改善ポイント

### 現状の問題点
- 抽象的すぎる質問（例: 「どう感じているの？」）
- ユーザーの状況を無視した質問
- 具体的なアクションへの誘導が弱い

### 改善後の方向性
- 具体的な状況を聞く質問（例: 「いつ・どこで・誰と・何が」）
- ユーザーの体験に基づいた質問
- 障害や制約を明確にする質問
- 実現可能な小さなアクションを引き出す質問

# データベース関連の変更

なし（プロンプトのみの変更）

# 編集するファイル名

- `src/lib/prompts.ts`（修正）

# 新たに導入するライブラリ

なし

# タスク

- [x] `generateListenerPrompt()`を改善
  - [x] 共通目的「なぜなぜ分析→具体的なアクション」を明記
  - [x] depth 0-1: モヤモヤの具体的な状況を聞く（いつ・どこで・何が起きたか）
  - [x] depth 2-3: 障害や感情の背景を具体的に聞く（何が引っかかっているのか、何が不安なのか）
  - [x] depth 4: 小さく具体的な一歩を引き出す（明日できること、5分でできること）
  - [x] 答えやすい質問例と悪い質問例を追加
- [x] `generateDoitkunPrompt()`を改善
  - [x] 共通目的「なぜなぜ分析→具体的なアクション」を明記
  - [x] depth 0-1: モヤモヤの具体的な理由を聞く（何が原因か、何がきっかけか）
  - [x] depth 2-3: 本当の障害を特定する（何が君を止めているのか、何が必要なのか）
  - [x] depth 4: 具体的な行動を引き出す（明日の9時に何をする？最初の5分で何をする？）
  - [x] 脳筋キャラを維持しつつ、実用的な質問に改善
- [x] 直前の回答に焦点を当てる改善
  - [x] `PromptContext`に`previousQuestion`と`previousAnswer`を追加
  - [x] `actions.ts`で直前の質問と回答を取得
  - [x] プロンプト内で「直前の回答」を明示し、それに対する深堀りを指示
  - [x] 「これまでの会話」は参考情報として残す
- [ ] 動作確認
  - [ ] ドゥイットくんで深堀りを試し、直前の回答に対して質問が生成されるか確認
  - [ ] リスナーさんで深堀りを試し、直前の回答に対して質問が生成されるか確認
  - [ ] 答えやすく具体的なアクションが出るか確認
  - [ ] 両キャラクターの違いが適切に表現されているか確認
- [ ] ユーザーにチェックをもらう（必須）
